# Calendar

Минимальный API сервис для работы с календарем, созданный с помощью фреймворка Flask.

Требования:

— API интерфейс CRUD — Добавление / Список / Чтение / Обновление / Удаление
— модель данных "Событие": ID, Дата, Заголовок, Текст
— локальное хранилище данных
— максимальная длина заголовка — 30 символов
— максимальная длина поля Текст — 200 символов
— нельзя добавить больше одного события в день
— API интерфейс: /api/v1/calendar/…
— формат данных: "ГГГГ-ММ-ДД|заголовок|текст"
_________________________________________

Для работы программы потребуется компьютер с операционной системой Windows. 
Программа требует наличия установленного Python 3.11 или более поздней версии.
Сервис написан в приложении VSCode.

________Порядок запуска сервиса__________

/// Открыть проект в VSCode

/// Установить фреймворк Flask: pip install flask

/// Активировать виртуальное окружение: venv\Scripts\activate

/// Команда для запуска сервиса: flask --app server.py run
_________________________________________

/// Model.py

Этот код создает класс Event, который будет использоваться для хранения информации об определенном событии. 
Класс имеет четыре атрибута: id, date, title и text. Атрибуты id и date имеют тип str, а title и text - строковые значения.
_________________________________________

/// Api.py

Код представляет собой веб-приложение, написанное на Python с использованием фреймворка Flask. 
Это приложение предоставляет RESTful API для управления событиями. Пользователь может создавать, читать, обновлять и удалять события через HTTP-запросы.
Класс ApiException используется для обработки исключений, которые могут возникнуть при работе с API. 
Функции _from_raw и _to_raw используются для преобразования данных между форматами.
Маршрутизация запросов осуществляется с помощью декораторов @app.route. 
Например, метод create принимает POST-запрос к маршруту /api/v1/calendar/event/ и создает новое событие. 
Метод list_ принимает GET-запрос к тому же маршруту и возвращает список всех событий. 
Методы read, update и delete работают аналогично, но принимают разные методы HTTP и параметры URL.
При запуске приложения в режиме отладки (debug=True), Flask автоматически перезапускает сервер при каждом изменении кода, что упрощает разработку и отладку."""
_________________________________________

/// Db.py

Этот код определяет класс EventDB, который предоставляет методы для работы с базой данных событий. 
Класс использует модули model и storage для взаимодействия с данными.
Метод init инициализирует экземпляр класса, устанавливая ссылку на объект LocalStorage из модуля storage.
Методы create, list, read, update и delete предоставляют функциональность CRUD 
(создание, чтение, обновление, удаление) для работы с событиями. 
Каждый из этих методов вызывает соответствующий метод объекта LocalStorage, который выполняет операцию с базой данных.
Если при выполнении операции возникает исключение, класс DBException используется для обработки ошибки и генерации сообщения об ошибке.
_________________________________________

/// Logic.py

Этот код определяет класс EventLogic, который предоставляет логику для работы с событиями. 
Класс использует класс EventDB из модуля db для доступа к базе данных.
Метод init инициализирует экземпляр класса, устанавливая ссылку на объект EventDB.
Методы create, list, read, update и delete предоставляют функциональность CRUD для работы с событиями. 
Каждый из этих методов вызывает соответствующий метод объекта EventDB, который затем выполняет операцию с базой данных.
Перед выполнением любой операции с событием, метод _validate_event проверяет корректность предоставленных данных. 
Он проверяет, что событие не является None, что длина заголовка и текста не превышают установленные ограничения, и что событие не создается чаще одного раза в день.
Если при выполнении операции возникает исключение, класс EventException используется для обработки ошибки и генерации сообщения об ошибке.
_________________________________________

/// Server.py

Эта строка импортирует объект app из модуля api. 
Объект app обычно представляет собой экземпляр класса Flask, 
который используется для создания веб-приложения.
_________________________________________

/// Storage.py

Этот код определяет класс LocalStorage, который представляет собой простую реализацию хранилища данных для событий. 
Класс использует класс model.Event для представления событий.
Метод init инициализирует экземпляр класса, устанавливая счетчик идентификаторов и пустое словарное значение для хранения событий.
Метод create увеличивает счетчик идентификаторов, присваивает новый идентификатор событию и добавляет его в словарь хранения.
Методы list, read, update и delete предоставляют функциональность CRUD для работы с событиями. 
Они используют словарь _storage для доступа к данным.
Если при выполнении операции возникает исключение, 
класс StorageException используется для обработки ошибки и генерации сообщения об ошибке.
_________________________________________
_________________________________________
_________________________________________

Тестирование приложения в PowerShell 7 Preview:

Запрос POST для создания события
Запрос	/ Результат
PS C:\Users\marin\Python\Calendar\Calendar> curl http://127.0.0.1:5000/api/v1/calendar/ -X POST -d "2022-01-01|тест|тест"	      / new id: 1
PS C:\Users\marin\Python\Calendar\Calendar> curl http://127.0.0.1:5000/api/v1/calendar/ -X POST -d "2|2022-01-01|тест|тест"	    / new id: 2
PS C:\Users\marin\Python\Calendar\Calendar> curl http://127.0.0.1:5000/api/v1/calendar/ -X POST -d "2022-01-01|тест|тест"	      / new id: 3

Запрос GET для получения списка событий
Запрос	/ Результат
curl http://127.0.0.1:5000/api/v1/calendar/event/ -X GET	        / 1|2022-01-01|тест|тест
2|2022-01-01|тест|тест
3|2022-01-01|тест|тест

Запрос GET для чтения события по id
Запрос	/ Результат
curl http://127.0.0.1:5000/api/v1/calendar/event/1/ -X GET	      / 1|2022-01-01|тест|тест
curl http://127.0.0.1:5000/api/v1/calendar/event/2/ -X GET	      / 2|2022-01-01|тест|тест
curl http://127.0.0.1:5000/api/v1/calendar/event/4/ -X GET	      / failed to READ with: failed READ operation with: failed READ operation with: 4 not found in storage

Запрос PUT для изменения события
Запрос	/ Результат
curl http://127.0.0.1:5000/api/v1/calendar/event/2/ -X PUT -d "2|2024-07-18|Day 5|The weather is good"	/ failed to UPDATE with: Not allowed to create more than one note per day
curl http://127.0.0.1:5000/api/v1/calendar/event/2/ -X PUT -d "2|2024-07-11|Day 5|The weather is good"	/ updated
curl http://127.0.0.1:5000/api/v1/calendar/event/2/ -X GET
вывести измененное событие	                                                                            / 2|2024-07-11|Day 5|The weather is good
curl http://127.0.0.1:5000/api/v1/calendar/event/3/ -X PUT -d "3|2024-07-18|.....|I work"
обновление события	                                                                                    / failed to UPDATE with: Not allowed to create more than one note per day
curl http://127.0.0.1:5000/api/v1/calendar/event/1/ -X PUT -d "2024-07-01|.....|I work"
обновление события с указанием другой даты	                                                            / updated


Запрос DELETE для удаления события по id
Запрос	/ Результат
curl http://127.0.0.1:5000/api/v1/calendar/event/3/ -X DELETE	        / deleted
curl http://127.0.0.1:5000/api/v1/calendar/event/3/ -X GET
вывести удаленное событие	                                            / failed to READ with: failed READ operation with: failed READ operation with: 3 not found in storage
curl http://127.0.0.1:5000/api/v1/calendar/event/ -X GET
вывести измененный список событий	                                    / 1|2024-07-01|.....|I work
                                                                      / 2|2024-07-11|Day 5|The weather is good


